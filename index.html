<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Language Translator</title>
  <style>
    :root {
      --primary-color: #356aff;
      --primary-color-dark: #2856e2;
      --bg-color: #f4f7fc;
      --card-bg-color: #ffffff;
      --text-color: #333;
      --text-color-light: #777;
      --border-color: #e0e0e0;
      --shadow-color: rgba(0, 0, 0, 0.08);
      --icon-color: #999;
      --icon-hover-color: #555;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-size: 16px;
      padding: 1rem;
    }

    .translator-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 1rem;
      width: 100%;
      max-width: 1100px;
    }

    .card {
      flex: 1;
      background-color: var(--card-bg-color);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-color);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
    }

    .language-selector {
      position: relative;
      margin-bottom: 1rem;
    }

    .select-box {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .select-box:hover, .select-box.active {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(53, 106, 255, 0.2);
    }
    
    .select-box input {
      flex: 1;
      border: none;
      background: transparent;
      font-size: 1rem;
      padding-right: 1rem;
    }

    .select-box input:focus {
      outline: none;
    }

    .select-box .arrow-icon {
      transition: transform 0.3s ease;
    }

    .select-box.active .arrow-icon {
      transform: rotate(180deg);
    }
    
    .language-list {
      position: absolute;
      top: calc(100% + 5px);
      left: 0;
      width: 100%;
      list-style: none;
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      max-height: 250px;
      overflow-y: auto;
      opacity: 0;
      transform: scaleY(0.95);
      transform-origin: top;
      transition: opacity 0.2s ease, transform 0.2s ease;
      z-index: 10;
      pointer-events: none;
    }

    .language-list.active {
      opacity: 1;
      transform: scaleY(1);
      pointer-events: auto;
    }

    .language-list li {
      padding: 0.75rem 1rem;
      cursor: pointer;
      transition: background-color 0.2s ease;
      font-size: 1rem;
    }

    .language-list li:hover, .language-list li.selected {
      background-color: var(--bg-color);
      color: var(--primary-color);
      font-weight: 500;
    }

    .textarea-container {
      position: relative;
    }
    
    textarea {
      width: 100%;
      padding: 1rem;
      padding-bottom: 3rem; /* Space for controls */
      font-size: 1.1rem;
      line-height: 1.6;
      background-color: transparent;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      resize: none;
      min-height: 200px;
      transition: border-color 0.2s;
    }
    
    textarea:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    #output-text.loading {
      opacity: 0.6;
      cursor: wait;
    }

    .controls {
      position: absolute;
      bottom: 1rem;
      left: 1rem;
      right: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .text-controls {
      display: flex;
      gap: 0.75rem;
    }

    .icon-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      color: var(--icon-color);
      transition: color 0.2s;
    }

    .icon-btn:hover {
      color: var(--icon-hover-color);
    }

    .icon-btn svg {
      width: 20px;
      height: 20px;
      vertical-align: middle;
    }
    
    .char-count {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }
    
    .swap-button-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #swap-btn {
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--primary-color);
      transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
    }

    #swap-btn:hover {
      background-color: var(--primary-color);
      color: white;
      transform: rotate(180deg);
    }

    #swap-btn:active {
      transform: rotate(180deg) scale(0.95);
    }

    @media (max-width: 900px) {
      .translator-container {
        flex-direction: column;
        gap: 1rem;
        align-items: center;
      }
      .card {
        width: 100%;
        max-width: 500px;
      }
      .swap-button-container {
        width: 100%;
        max-width: 500px;
        order: 1; /* Move swap button between cards */
      }
      #swap-btn {
        transform: rotate(90deg);
      }
       #swap-btn:hover {
        transform: rotate(270deg);
      }
      #swap-btn:active {
        transform: rotate(270deg) scale(0.95);
      }
      .card.input-card { order: 0; }
      .card.output-card { order: 2; }
    }
  </style>
</head>
<body>

  <div class="translator-container">
    <!-- Input Card -->
    <div class="card input-card">
      <div class="language-selector">
        <div class="select-box" id="input-lang-box">
          <input type="text" id="input-search" placeholder="Select a language" autocomplete="off">
          <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </div>
        <ul class="language-list" id="input-lang-list"></ul>
      </div>
      <div class="textarea-container">
        <textarea id="input-text" placeholder="Enter text..."></textarea>
        <div class="controls">
          <div class="text-controls">
            <button class="icon-btn" id="input-speak-btn" title="Listen">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
            </button>
            <button class="icon-btn" id="input-copy-btn" title="Copy text">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
          </div>
          <div class="char-count" id="char-count">0 / 5000</div>
        </div>
      </div>
    </div>

    <!-- Swap Button -->
    <div class="swap-button-container">
      <button class="icon-btn" id="swap-btn" title="Swap languages">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
      </button>
    </div>

    <!-- Output Card -->
    <div class="card output-card">
      <div class="language-selector">
        <div class="select-box" id="output-lang-box">
          <input type="text" id="output-search" placeholder="Select a language" autocomplete="off">
          <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </div>
        <ul class="language-list" id="output-lang-list"></ul>
      </div>
      <div class="textarea-container">
        <textarea id="output-text" placeholder="Translation" readonly></textarea>
        <div class="controls">
          <div class="text-controls">
            <button class="icon-btn" id="output-speak-btn" title="Listen">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
            </button>
            <button class="icon-btn" id="output-copy-btn" title="Copy text">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- STATE & CONFIGURATION ---
    let sourceLang = 'auto';
    let targetLang = 'en';
    let debounceTimer;

    const languages = [
        { name: "Auto Detect", code: "auto" }, { name: "Afrikaans", code: "af" }, { name: "Albanian", code: "sq" },
        { name: "Arabic", code: "ar" }, { name: "Armenian", code: "hy" }, { name: "Azerbaijani", code: "az" },
        { name: "Basque", code: "eu" }, { name: "Bengali", code: "bn" }, { name: "Bosnian", code: "bs" },
        { name: "Bulgarian", code: "bg" }, { name: "Catalan", code: "ca" }, { name: "Chinese (Simplified)", code: "zh-CN" },
        { name: "Chinese (Traditional)", code: "zh-TW" }, { name: "Croatian", code: "hr" }, { name: "Czech", code: "cs" },
        { name: "Danish", code: "da" }, { name: "Dutch", code: "nl" }, { name: "English", code: "en" },
        { name: "Esperanto", code: "eo" }, { name: "Estonian", code: "et" }, { name: "Finnish", code: "fi" },
        { name: "French", code: "fr" }, { name: "Galician", code: "gl" }, { name: "Georgian", code: "ka" },
        { name: "German", code: "de" }, { name: "Greek", code: "el" }, { name: "Gujarati", code: "gu" },
        { name: "Haitian Creole", code: "ht" }, { name: "Hausa", code: "ha" }, { name: "Hebrew", code: "he" },
        { name: "Hindi", code: "hi" }, { name: "Hmong", code: "hmn" }, { name: "Hungarian", code: "hu" },
        { name: "Icelandic", code: "is" }, { name: "Irish", code: "ga" }, { name: "Italian", code: "it" },
        { name: "Japanese", code: "ja" }, { name: "Javanese", code: "jv" }, { name: "Kazakh", code: "kk" },
        { name: "Khmer", code: "km" }, { name: "Korean", code: "ko" }, { name: "Lao", code: "lo" },
        { name: "Latvian", code: "lv" }, { name: "Lithuanian", code: "lt" }, { name: "Macedonian", code: "mk" },
        { name: "Malay", code: "ms" }, { name: "Malayalam", code: "ml" }, { name: "Maltese", code: "mt" },
        { name: "Marathi", code: "mr" }, { name: "Mongolian", code: "mn" }, { name: "Nepali", code: "ne" },
        { name: "Norwegian", code: "no" }, { name: "Pashto", code: "ps" }, { name: "Polish", code: "pl" },
        { name: "Portuguese", code: "pt" }, { name: "Punjabi", code: "pa" }, { name: "Quechua", code: "qu" },
        { name: "Romanian", code: "ro" }, { name: "Russian", code: "ru" }, { name: "Serbian", code: "sr" },
        { name: "Sesotho", code: "st" }, { name: "Sinhalese", code: "si" }, { name: "Slovak", code: "sk" },
        { name: "Somali", code: "so" }, { name: "Spanish", code: "es" }, { name: "Swahili", code: "sw" },
        { name: "Swedish", code: "sv" }, { name: "Tajik", code: "tg" }, { name: "Tamil", code: "ta" },
        { name: "Tatar", code: "tt" }, { name: "Telugu", code: "te" }, { name: "Thai", code: "th" },
        { name: "Tigrinya", code: "ti" }, { name: "Turkish", code: "tr" }, { name: "Turkmen", code: "tk" },
        { name: "Ukrainian", code: "uk" }, { name: "Uzbek", code: "uz" }, { name: "Vietnamese", code: "vi" },
        { name: "Welsh", code: "cy" }, { name: "Yiddish", code: "yi" }, { name: "Zulu", code: "zu" }
    ];

    // --- DOM ELEMENT SELECTION ---
    const dom = {
        input: {
            text: document.getElementById('input-text'),
            search: document.getElementById('input-search'),
            langBox: document.getElementById('input-lang-box'),
            langList: document.getElementById('input-lang-list'),
            speakBtn: document.getElementById('input-speak-btn'),
            copyBtn: document.getElementById('input-copy-btn'),
            charCount: document.getElementById('char-count'),
        },
        output: {
            text: document.getElementById('output-text'),
            search: document.getElementById('output-search'),
            langBox: document.getElementById('output-lang-box'),
            langList: document.getElementById('output-lang-list'),
            speakBtn: document.getElementById('output-speak-btn'),
            copyBtn: document.getElementById('output-copy-btn'),
        },
        swapBtn: document.getElementById('swap-btn'),
    };

    // --- FUNCTIONS ---

    /** Populates a language dropdown with options */
    const populateLanguageList = (listElement, availableLanguages, selectedCode) => {
        listElement.innerHTML = '';
        availableLanguages.forEach(lang => {
            const li = document.createElement('li');
            li.textContent = lang.name;
            li.dataset.code = lang.code;
            if (lang.code === selectedCode) {
                li.classList.add('selected');
            }
            listElement.appendChild(li);
        });
    };

    /** Filters and displays languages based on search query */
    const filterAndDisplayLanguages = (query, listElement, availableLanguages, selectedCode) => {
        const filtered = availableLanguages.filter(lang =>
            lang.name.toLowerCase().includes(query.toLowerCase())
        );
        populateLanguageList(listElement, filtered, selectedCode);
        listElement.classList.add('active');
    };

    /** Sets the selected language for input or output */
    const setLanguage = (type, code) => {
        const lang = languages.find(l => l.code === code);
        if (!lang) return;

        if (type === 'input') {
            sourceLang = code;
            dom.input.search.value = lang.name;
            updateSelectedListItem(dom.input.langList, code);
        } else {
            targetLang = code;
            dom.output.search.value = lang.name;
            updateSelectedListItem(dom.output.langList, code);
        }

        if (dom.input.text.value.trim()) {
            translate();
        }
    };
    
    /** Updates the 'selected' class on a list item */
    const updateSelectedListItem = (list, code) => {
        const currentlySelected = list.querySelector('.selected');
        if (currentlySelected) currentlySelected.classList.remove('selected');
        const newItem = list.querySelector(`[data-code="${code}"]`);
        if (newItem) newItem.classList.add('selected');
    };
    
    /** Core translation function */
    const translate = async () => {
        const text = dom.input.text.value.trim();
        if (!text || sourceLang === targetLang) {
            dom.output.text.value = text; // Copy text if langs are same
            return;
        }

        dom.output.text.classList.add('loading');
        dom.output.text.placeholder = 'Translating...';

        try {
            // Note: This uses an unofficial, rate-limited Google Translate API.
            // For production use, a dedicated translation API service is recommended.
            const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sourceLang}&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
            const response = await fetch(url);
            if (!response.ok) throw new Error('Network response was not ok');
            const data = await response.json();
            
            // The API returns a nested array; we need to piece together the translation.
            const translatedText = data[0].map(item => item[0]).join('');
            dom.output.text.value = translatedText;
            
        } catch (error) {
            console.error('Translation Error:', error);
            dom.output.text.value = 'Error: Could not translate.';
        } finally {
            dom.output.text.classList.remove('loading');
            dom.output.text.placeholder = 'Translation';
        }
    };

    /** Swaps source and target languages and text */
    const swapLanguages = () => {
        // Prevent swapping to 'auto' as a target language
        if (sourceLang === 'auto') return;

        [sourceLang, targetLang] = [targetLang, sourceLang];
        [dom.input.text.value, dom.output.text.value] = [dom.output.text.value, dom.input.text.value];
        [dom.input.search.value, dom.output.search.value] = 
            [languages.find(l => l.code === sourceLang).name, languages.find(l => l.code === targetLang).name];

        updateSelectedListItem(dom.input.langList, sourceLang);
        updateSelectedListItem(dom.output.langList, targetLang);
        
        if (dom.input.text.value.trim()) {
            translate();
        }
    };

    /** Copies text to the clipboard and provides user feedback */
    const copyToClipboard = (text, button) => {
        if (!text) return;
        navigator.clipboard.writeText(text).then(() => {
            const originalTitle = button.title;
            const originalIcon = button.innerHTML;
            button.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>`;
            button.title = "Copied!";
            setTimeout(() => {
                button.innerHTML = originalIcon;
                button.title = originalTitle;
            }, 1500);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy text.');
        });
    };
    
    /** Speaks text using the Web Speech API */
    const speakText = (text, langCode) => {
        if (!text || !window.speechSynthesis) return;
        // The Web Speech API language code format can differ (e.g., 'en-US')
        // We use the base code which works for most browsers/voices.
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = langCode === 'auto' ? '' : langCode.split('-')[0];
        speechSynthesis.cancel(); // Stop any previous speech
        speechSynthesis.speak(utterance);
    };

    // --- EVENT LISTENERS ---

    // Live translation on input
    dom.input.text.addEventListener('input', () => {
        const count = dom.input.text.value.length;
        dom.input.charCount.textContent = `${count} / 5000`;
        
        if (count > 5000) {
            dom.input.text.value = dom.input.text.value.substring(0, 5000);
        }

        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
            if (dom.input.text.value.trim() === '') {
                dom.output.text.value = '';
            } else {
                translate();
            }
        }, 300); // 300ms delay
    });
    
    // Language search and selection
    ['input', 'output'].forEach(type => {
        const searchEl = dom[type].search;
        const listEl = dom[type].langList;
        const boxEl = dom[type].langBox;
        
        // Open dropdown on click/focus
        searchEl.addEventListener('focus', () => {
            const availableLangs = (type === 'input') ? languages : languages.filter(l => l.code !== 'auto');
            populateLanguageList(listEl, availableLangs, type === 'input' ? sourceLang : targetLang);
            listEl.classList.add('active');
            boxEl.classList.add('active');
        });

        // Filter list on search input
        searchEl.addEventListener('input', () => {
            const availableLangs = (type === 'input') ? languages : languages.filter(l => l.code !== 'auto');
            filterAndDisplayLanguages(searchEl.value, listEl, availableLangs, type === 'input' ? sourceLang : targetLang);
        });

        // Handle language selection from list (using event delegation)
        listEl.addEventListener('click', (e) => {
            if (e.target.tagName === 'LI') {
                setLanguage(type, e.target.dataset.code);
                listEl.classList.remove('active');
                boxEl.classList.remove('active');
            }
        });
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.language-selector')) {
            dom.input.langList.classList.remove('active');
            dom.output.langList.classList.remove('active');
            dom.input.langBox.classList.remove('active');
            dom.output.langBox.classList.remove('active');
        }
    });

    // Swap, copy, and speak button listeners
    dom.swapBtn.addEventListener('click', swapLanguages);
    dom.input.copyBtn.addEventListener('click', () => copyToClipboard(dom.input.text.value, dom.input.copyBtn));
    dom.output.copyBtn.addEventListener('click', () => copyToClipboard(dom.output.text.value, dom.output.copyBtn));
    dom.input.speakBtn.addEventListener('click', () => speakText(dom.input.text.value, sourceLang));
    dom.output.speakBtn.addEventListener('click', () => speakText(dom.output.text.value, targetLang));

    // --- INITIALIZATION ---
    const initialize = () => {
        // Sort languages alphabetically, keeping "Auto Detect" at the top
        const autoDetect = languages.shift();
        languages.sort((a, b) => a.name.localeCompare(b.name));
        languages.unshift(autoDetect);

        // Populate lists initially (hidden)
        const outputLangs = languages.filter(l => l.code !== 'auto');
        populateLanguageList(dom.input.langList, languages, sourceLang);
        populateLanguageList(dom.output.langList, outputLangs, targetLang);
        
        // Set default display values
        setLanguage('input', 'auto');
        setLanguage('output', 'en');
        
        dom.input.text.value = '';
        dom.output.text.value = '';
    };

    initialize();
});
</script>
</body>
</html>
